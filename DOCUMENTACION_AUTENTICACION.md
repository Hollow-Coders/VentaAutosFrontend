# üìö Documentaci√≥n - Sistema de Autenticaci√≥n

## üìã √çndice
1. [Resumen de Cambios](#resumen-de-cambios)
2. [Nueva Estructura de Carpetas](#nueva-estructura-de-carpetas)
3. [Componentes Implementados](#componentes-implementados)
4. [Contexto de Autenticaci√≥n](#contexto-de-autenticaci√≥n)
5. [Flujo de Navegaci√≥n](#flujo-de-navegaci√≥n)
6. [Funciones y Hooks](#funciones-y-hooks)
7. [Recomendaciones](#recomendaciones)
8. [Pr√≥ximos Pasos](#pr√≥ximos-pasos)

---

## üîÑ Resumen de Cambios

### Cambios Principales Realizados:
- ‚úÖ **Reorganizaci√≥n completa** de la estructura de carpetas
- ‚úÖ **Implementaci√≥n de rutas agrupadas** (public), (auth), (protected)
- ‚úÖ **Sistema de autenticaci√≥n** con Context API
- ‚úÖ **Navbar inteligente** que se adapta al estado del usuario
- ‚úÖ **Formularios mejorados** con validaci√≥n y estados de carga
- ‚úÖ **Componentes modulares** para acciones que requieren autenticaci√≥n
- ‚úÖ **Flujo de usuario optimizado** para visitantes y usuarios registrados

### Beneficios Obtenidos:
- üöÄ **Mejor UX**: Navegaci√≥n libre con acciones protegidas
- üèóÔ∏è **Arquitectura escalable**: F√°cil agregar nuevas funcionalidades
- üîß **Mantenibilidad**: C√≥digo organizado y modular
- üì± **Responsive**: Dise√±o adaptable a todos los dispositivos
- üéØ **SEO friendly**: P√°ginas p√∫blicas indexables

---

## üìÅ Nueva Estructura de Carpetas

```
src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ (public)/              # üü¢ Rutas p√∫blicas (acceso libre)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx          # P√°gina de inicio
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ catalogo/         # Cat√°logo de veh√≠culos
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ subastas/         # P√°gina de subastas
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ contacto/         # P√°gina de contacto
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ page.tsx
‚îÇ   ‚îú‚îÄ‚îÄ (auth)/               # üîê Rutas de autenticaci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login/            # P√°gina de login
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ register/         # P√°gina de registro
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ layout.tsx        # Layout sin navbar para auth
‚îÇ   ‚îú‚îÄ‚îÄ (protected)/          # üõ°Ô∏è Rutas protegidas (preparadas)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/        # Dashboard del usuario
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ perfil/           # Perfil del usuario
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mis-pujas/        # Historial de pujas
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mis-compras/      # Historial de compras
‚îÇ   ‚îî‚îÄ‚îÄ layout.tsx            # Layout principal con AuthProvider
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ auth/                 # üîë Componentes de autenticaci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginForm.tsx     # Formulario de login mejorado
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RegisterForm.tsx  # Formulario de registro mejorado
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuthLayout.tsx    # Layout para p√°ginas de auth
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AuthPrompt.tsx    # Modal para acciones que requieren auth
‚îÇ   ‚îú‚îÄ‚îÄ layout/               # üèóÔ∏è Componentes de layout
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Navbar.tsx        # Navbar con estados de auth
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Footer.tsx        # Footer
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UserMenu.tsx      # Men√∫ desplegable del usuario
‚îÇ   ‚îú‚îÄ‚îÄ vehicle/              # üöó Componentes de veh√≠culos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Carta_v.tsx       # Tarjeta de veh√≠culo
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BidButton.tsx     # Bot√≥n de puja con l√≥gica de auth
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ BuyButton.tsx     # Bot√≥n de compra con l√≥gica de auth
‚îÇ   ‚îî‚îÄ‚îÄ ui/                   # üé® Componentes UI reutilizables
‚îÇ       ‚îî‚îÄ‚îÄ boton_catalogo.tsx
‚îú‚îÄ‚îÄ context/
‚îÇ   ‚îî‚îÄ‚îÄ AuthContext.tsx       # üåê Contexto global de autenticaci√≥n
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îî‚îÄ‚îÄ useAuth.ts            # ü™ù Hook personalizado para auth
‚îî‚îÄ‚îÄ lib/
    ‚îî‚îÄ‚îÄ (preparado para utilidades)
```

---

## üß© Componentes Implementados

### 1. **AuthContext.tsx** - Contexto Global
```typescript
// Ubicaci√≥n: src/context/AuthContext.tsx
// Funci√≥n: Maneja el estado global de autenticaci√≥n

interface User {
  id: string;
  name: string;
  email: string;
  avatar?: string;
}

interface AuthContextType {
  user: User | null;           // Usuario actual
  isAuthenticated: boolean;    // Estado de autenticaci√≥n
  isLoading: boolean;          // Estado de carga
  login: (email: string, password: string) => Promise<void>;
  register: (name: string, email: string, password: string) => Promise<void>;
  logout: () => void;
}
```

**Caracter√≠sticas:**
- ‚úÖ Estado global de autenticaci√≥n
- ‚úÖ Funciones de login, register y logout
- ‚úÖ Manejo de estados de carga
- ‚úÖ Simulaci√≥n de API (listo para integraci√≥n real)

### 2. **useAuth.ts** - Hook Personalizado
```typescript
// Ubicaci√≥n: src/hooks/useAuth.ts
// Funci√≥n: Hook para acceder f√°cilmente al contexto de auth

export const useAuth = useAuthContext;
```

**Uso:**
```typescript
const { user, isAuthenticated, login, logout } = useAuth();
```

### 3. **Navbar.tsx** - Navegaci√≥n Inteligente
```typescript
// Ubicaci√≥n: src/components/layout/Navbar.tsx
// Funci√≥n: Navbar que se adapta al estado del usuario

// Estados del navbar:
// - Usuario NO autenticado: Muestra botones "Iniciar Sesi√≥n/Registrarse"
// - Usuario autenticado: Muestra men√∫ de usuario con dropdown
// - Estado de carga: Muestra spinner de carga
```

**Caracter√≠sticas:**
- ‚úÖ Navegaci√≥n siempre visible (Inicio, Cat√°logo, Subastas, Contacto)
- ‚úÖ Botones de auth condicionales
- ‚úÖ Men√∫ de usuario desplegable
- ‚úÖ Estados de carga
- ‚úÖ Responsive design

### 4. **UserMenu.tsx** - Men√∫ de Usuario
```typescript
// Ubicaci√≥n: src/components/layout/UserMenu.tsx
// Funci√≥n: Men√∫ desplegable para usuarios autenticados

// Opciones del men√∫:
// - Mi Dashboard
// - Mi Perfil
// - Mis Pujas
// - Mis Compras
// - Cerrar Sesi√≥n
```

**Caracter√≠sticas:**
- ‚úÖ Dropdown con informaci√≥n del usuario
- ‚úÖ Enlaces a p√°ginas protegidas
- ‚úÖ Funci√≥n de logout
- ‚úÖ Overlay para cerrar el men√∫
- ‚úÖ Animaciones suaves

### 5. **LoginForm.tsx** - Formulario de Login
```typescript
// Ubicaci√≥n: src/components/auth/LoginForm.tsx
// Funci√≥n: Formulario de inicio de sesi√≥n mejorado

// Campos:
// - Email (requerido)
// - Contrase√±a (requerido)
// - Recordarme (checkbox)
// - ¬øOlvidaste tu contrase√±a? (enlace)
```

**Caracter√≠sticas:**
- ‚úÖ Validaci√≥n de campos
- ‚úÖ Estados de carga
- ‚úÖ Manejo de errores
- ‚úÖ Integraci√≥n con AuthContext
- ‚úÖ Redirecci√≥n autom√°tica despu√©s del login
- ‚úÖ Dise√±o responsive

### 6. **RegisterForm.tsx** - Formulario de Registro
```typescript
// Ubicaci√≥n: src/components/auth/RegisterForm.tsx
// Funci√≥n: Formulario de registro mejorado

// Campos:
// - Nombre completo (requerido)
// - Email (requerido)
// - Contrase√±a (requerido, m√≠nimo 8 caracteres)
// - Confirmar contrase√±a (requerido)
// - T√©rminos y condiciones (checkbox requerido)
```

**Caracter√≠sticas:**
- ‚úÖ Validaci√≥n de contrase√±as coincidentes
- ‚úÖ Estados de carga
- ‚úÖ Manejo de errores
- ‚úÖ Integraci√≥n con AuthContext
- ‚úÖ Redirecci√≥n autom√°tica despu√©s del registro
- ‚úÖ Enlaces a t√©rminos y condiciones

### 7. **AuthPrompt.tsx** - Modal de Autenticaci√≥n
```typescript
// Ubicaci√≥n: src/components/auth/AuthPrompt.tsx
// Funci√≥n: Modal que aparece cuando se intenta una acci√≥n que requiere auth

// Props:
// - onClose: Funci√≥n para cerrar el modal
// - action: Descripci√≥n de la acci√≥n que requiere auth
```

**Caracter√≠sticas:**
- ‚úÖ Modal centrado con overlay
- ‚úÖ Mensaje personalizable seg√∫n la acci√≥n
- ‚úÖ Botones para login y registro
- ‚úÖ Bot√≥n de cancelar
- ‚úÖ Dise√±o atractivo

### 8. **BidButton.tsx** - Bot√≥n de Puja
```typescript
// Ubicaci√≥n: src/components/vehicle/BidButton.tsx
// Funci√≥n: Bot√≥n para pujar en subastas con l√≥gica de auth

// Props:
// - vehicle: Informaci√≥n del veh√≠culo
// - currentBid: Puja actual (opcional)
```

**Caracter√≠sticas:**
- ‚úÖ Verifica estado de autenticaci√≥n
- ‚úÖ Muestra AuthPrompt si no est√° autenticado
- ‚úÖ Texto din√°mico seg√∫n el estado
- ‚úÖ Integraci√≥n con AuthContext

### 9. **BuyButton.tsx** - Bot√≥n de Compra
```typescript
// Ubicaci√≥n: src/components/vehicle/BuyButton.tsx
// Funci√≥n: Bot√≥n para comprar veh√≠culos con l√≥gica de auth

// Props:
// - vehicle: Informaci√≥n del veh√≠culo
```

**Caracter√≠sticas:**
- ‚úÖ Verifica estado de autenticaci√≥n
- ‚úÖ Muestra AuthPrompt si no est√° autenticado
- ‚úÖ Texto din√°mico seg√∫n el estado
- ‚úÖ Integraci√≥n con AuthContext

---

## üåê Contexto de Autenticaci√≥n

### **AuthProvider** - Proveedor del Contexto
```typescript
// Ubicaci√≥n: src/context/AuthContext.tsx

export function AuthProvider({ children }: { children: React.ReactNode }) {
  const [user, setUser] = useState<User | null>(null);
  const [isLoading, setIsLoading] = useState(true);

  // Funciones implementadas:
  const login = async (email: string, password: string) => Promise<void>;
  const register = async (name: string, email: string, password: string) => Promise<void>;
  const logout = () => void;

  return (
    <AuthContext.Provider value={value}>
      {children}
    </AuthContext.Provider>
  );
}
```

### **Integraci√≥n en Layout Principal**
```typescript
// Ubicaci√≥n: src/app/layout.tsx

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="es">
      <body>
        <AuthProvider>
          <Navbar />
          <main>{children}</main>
          <Footer/>
        </AuthProvider>
      </body>
    </html>
  );
}
```

---

## üö¶ Flujo de Navegaci√≥n

### **Usuario NO Autenticado (Visitante)**
```
1. Llega al sitio ‚Üí Ve navbar con botones "Iniciar Sesi√≥n/Registrarse"
2. Navega libremente ‚Üí Inicio, Cat√°logo, Subastas, Contacto
3. Ve veh√≠culos ‚Üí Puede ver todos los detalles y precios
4. Intenta pujar/comprar ‚Üí Aparece AuthPrompt
5. Se registra/inicia sesi√≥n ‚Üí Accede a funcionalidades completas
```

### **Usuario Autenticado**
```
1. Navbar cambia ‚Üí Muestra men√∫ de usuario
2. Acceso completo ‚Üí Todas las p√°ginas + funcionalidades premium
3. Puede pujar/comprar ‚Üí Botones funcionan directamente
4. Dashboard personal ‚Üí Acceso a historial y configuraciones
```

---

## ü™ù Funciones y Hooks

### **useAuth Hook**
```typescript
// Ubicaci√≥n: src/hooks/useAuth.ts

import { useAuth as useAuthContext } from '../context/AuthContext';
export const useAuth = useAuthContext;

// Uso en componentes:
const { 
  user,           // Usuario actual o null
  isAuthenticated, // boolean
  isLoading,      // boolean
  login,          // funci√≥n
  register,       // funci√≥n
  logout          // funci√≥n
} = useAuth();
```

### **Funciones del Contexto**

#### **login(email, password)**
- **Par√°metros**: email (string), password (string)
- **Retorna**: Promise<void>
- **Funci√≥n**: Autentica al usuario
- **Estado**: Actualiza user, isAuthenticated, isLoading

#### **register(name, email, password)**
- **Par√°metros**: name (string), email (string), password (string)
- **Retorna**: Promise<void>
- **Funci√≥n**: Registra nuevo usuario
- **Estado**: Actualiza user, isAuthenticated, isLoading

#### **logout()**
- **Par√°metros**: Ninguno
- **Retorna**: void
- **Funci√≥n**: Cierra sesi√≥n del usuario
- **Estado**: Limpia user, isAuthenticated = false

---

## üí° Recomendaciones

### **1. Seguridad**
- üîê **Implementar validaci√≥n real** en el backend
- üîê **Usar HTTPS** para todas las comunicaciones
- üîê **Implementar JWT** o tokens seguros
- üîê **Validar contrase√±as** con criterios de seguridad
- üîê **Implementar rate limiting** para prevenir ataques

### **2. UX/UI**
- üé® **Agregar animaciones** de transici√≥n entre estados
- üé® **Implementar notificaciones** toast para feedback
- üé® **Agregar loading states** m√°s detallados
- üé® **Implementar dark mode** si es necesario
- üé® **Optimizar para m√≥viles** con gestos t√°ctiles

### **3. Performance**
- ‚ö° **Implementar lazy loading** para componentes pesados
- ‚ö° **Optimizar im√°genes** con Next.js Image
- ‚ö° **Implementar caching** para datos de usuario
- ‚ö° **Usar React.memo** para componentes que no cambian frecuentemente
- ‚ö° **Implementar service workers** para offline support

### **4. Funcionalidades Adicionales**
- üîÑ **Implementar "Recordarme"** con persistencia
- üîÑ **Agregar recuperaci√≥n de contrase√±a**
- üîÑ **Implementar verificaci√≥n de email**
- üîÑ **Agregar autenticaci√≥n social** (Google, Facebook)
- üîÑ **Implementar 2FA** para mayor seguridad

### **5. Testing**
- üß™ **Implementar tests unitarios** para componentes
- üß™ **Agregar tests de integraci√≥n** para flujos de auth
- üß™ **Implementar tests E2E** con Playwright
- üß™ **Agregar tests de accesibilidad**
- üß™ **Implementar tests de performance**

---

## üöÄ Pr√≥ximos Pasos

### **Fase 1: Integraci√≥n Backend (Inmediata)**
1. **Reemplazar funciones simuladas** en AuthContext.tsx
2. **Conectar con API real** (REST, GraphQL, etc.)
3. **Implementar manejo de errores** real
4. **Agregar persistencia** (localStorage, cookies)

### **Fase 2: Funcionalidades Avanzadas (Corto plazo)**
1. **Implementar rutas protegidas** reales
2. **Agregar middleware de auth** para Next.js
3. **Implementar refresh tokens**
4. **Agregar validaci√≥n de formularios** m√°s robusta

### **Fase 3: Optimizaci√≥n (Mediano plazo)**
1. **Implementar lazy loading** de rutas
2. **Agregar caching** de datos de usuario
3. **Optimizar bundle size**
4. **Implementar PWA** features

### **Fase 4: Escalabilidad (Largo plazo)**
1. **Implementar microservicios** de auth
2. **Agregar analytics** de uso
3. **Implementar A/B testing**
4. **Agregar internacionalizaci√≥n**

---

## üìû Soporte y Contacto

### **Archivos Clave para Modificaciones:**
- `src/context/AuthContext.tsx` - L√≥gica principal de auth
- `src/components/layout/Navbar.tsx` - Navegaci√≥n principal
- `src/components/auth/` - Formularios de autenticaci√≥n
- `src/hooks/useAuth.ts` - Hook para usar auth

### **Comandos √ötiles:**
```bash
# Instalar dependencias
npm install

# Ejecutar en desarrollo
npm run dev

# Construir para producci√≥n
npm run build

# Ejecutar linter
npm run lint
```

### **Estructura de URLs:**
- `/` - P√°gina de inicio (p√∫blica)
- `/catalogo` - Cat√°logo de veh√≠culos (p√∫blica)
- `/subastas` - Subastas (p√∫blica)
- `/contacto` - Contacto (p√∫blica)
- `/login` - Iniciar sesi√≥n (auth)
- `/register` - Registrarse (auth)
- `/dashboard` - Dashboard (protegida)
- `/perfil` - Perfil de usuario (protegida)

---

## ‚úÖ Estado Actual del Proyecto

### **Completado:**
- ‚úÖ Estructura de carpetas reorganizada
- ‚úÖ Sistema de autenticaci√≥n implementado
- ‚úÖ Navbar con estados din√°micos
- ‚úÖ Formularios mejorados
- ‚úÖ Componentes modulares
- ‚úÖ Flujo de usuario optimizado
- ‚úÖ Dise√±o responsive
- ‚úÖ TypeScript implementado

### **Pendiente (Para integraci√≥n real):**
- ‚è≥ Conexi√≥n con backend real
- ‚è≥ Persistencia de sesi√≥n
- ‚è≥ Validaci√≥n de formularios robusta
- ‚è≥ Manejo de errores avanzado
- ‚è≥ Testing implementado
- ‚è≥ Documentaci√≥n de API

---

**üìù Documentaci√≥n creada el:** $(date)  
**üîÑ √öltima actualizaci√≥n:** $(date)  
**üë®‚Äçüíª Desarrollado por:** Asistente AI  
**üìß Contacto:** Para dudas sobre la implementaci√≥n
